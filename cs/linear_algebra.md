# Linear Algebra

## Reference

- 線形代数学, 斎藤正彦, 東京大学出版会

## ToC

1. [Terminology](#Terminology)
1. [連立一次方程式](#)
1. [Eigenvalue](#eigen)
1. [Product](#product)
1. [Matrix](#matrix)
1. [Matrix Decomposition](#composition)
1. [Mapping](#)
1. [Rank](#rank)
1. [Determinant](#)
1. [Vector](#vector)
1. [Tensor](#tensor)
1. [アフィン変換](#affin)

## Terminology

- rankA = dim Im A
- r 次の小行列式
- dimV = dimKer f + dimIm f
  - 線形写像の次元に関する基本定理
- 正方行列 A が定義する線形写像の同型性
- 線形作用素
- 線形変換
- 有界線形作用素
- 連続線形作用素
- SVD Decomposition 特異値分解

## 連立一次方程式

- 不定
- 不能
- 係数行列
- 拡大係数行列
- 連立斉一次方程式
- 連立一次方程式
- Ax = b に同伴する連立斉一次方程式
- 自明な解
- 解の自由度
- 解空間
- 解の種類
  - 基本解
  - 一般解
  - 特殊解
- 連立一次方程式の基本変形
- 行基本操作
  - 行基本変形
  - 列基本変形
- 基本行列
- 消去法 / 掃き出し法
- 階段行列
- 階段行列のランク
- 連立一次方程式と逆行列
- 連立一次方程式の解き方
  - 筆算法
  - ガウスジョルダン法
  - 逆行列を求めて掛ける
- 公式
  - クラーメルの公式
  - グラムシュミットの直交化法

## Eigenvalue 固有値

- 固有値
- 固有ベクトル
- 固有多項式 / 特性多項式
- 固有方程式
- 固有空間
- 固有空間の次元
- 三角行列の固有値
- 固有値の重複度
- 正則行列 A と B が相似
- 対角化
- 対角化可能
- 対角化の主定理
- 固有ベクトルの一次独立性
- 三角化
- 三角化可能
- 直交行列
- ハミルトンケーリーの定理

### 手計算による固有値の計算

- 特性多項式を計算する
- 特性方程式を解いて固有値を求める

### コンピュータによる固有値の計算

- Jacobi 法
  - QR 法よりも簡明
  - QR 法よりも柔軟性がある
- QR 法
  - Jacobi 法よりも高速
  - 手順
  - Hessenberg 行列に変形する
  - Householder 法を使う
  - QR 反復を行う：以下の繰り返し
  - 固有値を求めたい行列を QR 分解する
  - 分解した結果を逆順に掛け合わせる

## 内積と外積 <a name="product" id="product"></a>

- 内積 / スカラー積
- 外積 / ベクトル積
- 内積の幾何学的意味
- 外積の幾何学的意味
- Rn の標準的な内積 / 自然な内積
- 計量ベクトル空間 / 内積空間
- ノルム
  - ベクトルの長さ
- シュワルツの不等式
- 三角不等式
- ベクトルの直交
- ベクトルのなす角
- シュミットの正規直交化法
- 正規直交系
- 正規直交基底
- 直交補空間
- 直和
- 直和分解
- 長さを保つ
- 計量を保つ / 内積を保つ
- 計量同型
- 計量同型写像
- 直交変換
- 直交行列
- エルミット内積
- エルミット内積空間
- 複素計量ベクトル空間
- Lemma / Lem 補題
- Theorem / Thm 定理
- 積 np.dot(A,B)
- アダマール積 np.multiply(A,B)

## Matrix <a id="matrix" name="matrix"></a>

### 逆行列

- 逆行列
  - 正則行列のみに存在（というか、正則行列の定義が逆行列を持つこと）
  - 計算方法
    - A 　（正則行列のみに適用できる）
      - 余因子行列を行列式で割り、転置する
      - 計算量が多いのがこの手法の欠点
    - B 単位行列を右にくっつけ、変形して左を単位行列にする
    - C 拡大係数行列をつくり、変形して左を単位行列にする（ガウスの消去法、Gauss）
      - 変形操作
      - ある行を c 倍する
      - ある行を c 倍して他の行に加える
      - 行同士を入れ替える(pivoting)
      - 0 要素のせいで、左の行列を単位行列に変形できない時に活躍する操作
      - 用途
        - 連立一次方程式の解法など
    - D 　クラーメルの公式？
- 一般逆行列
  - 正則行列でない場合にも、逆行列っぽいものを持つよう拡張したもの
  - 「逆行列っぽさ」の解釈により、数種の一般逆行列が考えられる
- 擬似逆行列 aka Moore Penrose 逆行列
  - 狭義の一般化行列
  - もっとも誤差が小さい解を求められる
  - 求めた解は、A が縦長の場合は||Ax−b||2 を最小にする
  - A が横長の場合はノルム||x||を最小にする
- 正則行列
  - 逆行列が存在する行列
- 特異行列
  - 正則ではない行列

### 特殊な形状の行列

- 単位行列
- 対角行列
  - 対角成分以外全部ゼロ
- スカラー行列
  - 対角成分が全て同じ数
- 三角行列
  - 上三角行列と下三角行列のこと
- 上三角行列
  - 対角成分、及びその上の部分にゼロでない数字が入っている
- 下三角行列
  - 対角成分、及びその下の部分にゼロでない数字が入っている
- Hessenberg 行列
  - 上三角行列の対角成分のひとつ下まで 0 埋めになっている行列
- 階段行列
- 転置行列
- 共役転置行列
- 正方行列
  - 性質
    - 必ず対角化できる
      - 与えられた正方行列 A に対して，正則行列 P をうまく取ってきて P−1AP = J を対角行列にする操作
      - J はジョルダン標準形を対角に並べた形になる
  - 利点
    - A^n を簡単に計算できる
- 対称行列
  - A^T = A
  - A が n 次対称行列のとき、Q^T AQ = diag(λ1, λ2, . . . , λn) となるような n 次直交行列が存在する
    - ただし、diag()は対角行列
    - Q の各列ベクトル
  - 異なる固有値の固有ベクトルは直交する
  - 固有値は実数である
  - 固有値と特異値が一致する
  - 用途
    - 低ランク近似
    - 擬似逆行列の計算
- 正定値行列
  - 固有値が全て正である対称行列
  - 正定
  - 負定
  - 固有値による判別
    - 正定の判別
  - シルベスターの判定条件
    - 正定の判別
- 半正定値行列・準正定行列
  - 固有値が全て非負である対称行列
  - 実例
    - 分散・共分散行列：
    - モーメント行列
    - 確率分布の特性関数（＝密度関数のフーリエ変換）を ϕ(t) として aij = ϕ(ti − tj )
    - 力学系（ばね系やトラスなどの構造物）の質量行列 M と剛性行列 K
    - ラプラシアン ∆
- 交代行列
  - a_ij = -a_ji となる行列
  - 性質
    - この定義から，対角成分はゼロ
    - A^T = -A
- ゼロ行列
- 疎行列
- 密行列

### その他の行列

- 直交行列
  - 対称行列と自身の積が単位行列となる行列
- グラム行列
- 可観測性グラム行列
- 実行列
- 複素行列
- 正規行列
  - 行列と共役転置行列の掛け算順序が交換可能な行列のこと
  - ユニタリ行列、エルミート行列、歪エルミート行列など
- ユニタリ行列
  - 行列と共役転置行列の積が単位行列になる正規行列
  - 共役転置行列が、もとの行列の逆行列になる
- エルミート行列
  - 行列と共役転置行列が一致する正規行列
  - 固有値は必ず実数になる
  - 異なる固有値に属する固有ベクトルは、必ず直交する
  - ユニタリ行列によって対角化できる
- 歪エルミート行列
- ユニタリ行列でありエルミート行列でもある行列
- ヤコビ行列
- ヤコビアン
  - ヤコビ行列の行列式のこと
  - 座標変換などに用いる
- 余因子行列
- ブロック行列
- ブロック対角行列
- 相似行列
- ヘッセ行列
- 主小行列
- ジョルダン標準形
  - 対角成分に同じ値 λ を並べ，一つ上の部分には 1 を並べた行列
- ランク標準形
  - 任意の行列 A に対して正則行列 S,T をうまく取ってくれば SAT が以下のようなブロック行列になる
    - 左上が単位行列
    - 残りはゼロ行列
    - このとき、単位行列の次元が rank になっている
- 座標変換行列
  - 座標系
- 回転行列
  - 座標系
- 可観測性行列
  - 制御工学
- 逆変換行列 / 受動的変換行列
- 直接変換行列
- 基底変換

## Matrix Decomposition 行列分解 <a id="composition" name="composition"></a>

- 固有値分解
  - 正方行列にのみ定義される
- 特異値分解
  - A=UΣV に分解すること
    - A: m x n の任意の行列。
      - 固有値分解が正方行列だけだったこととは対照的
    - U: m x m の直交行列
      - 一意に決まるとは限らない
    - Σ: 非対角成分は 0，対角成分は非負で大きさの順に並んだ行列
      - A が与えられれば、必ず１意に決まる
    - V: n x n の直交行列
      - 一意に決まるとは限らない
- LU 分解 Singular-Value-Decomposition, SVD
  - m x n 行列 A を（ただし s = min(m, n)とする）
  - m x s 下三角行列 L 　 s x n 上三角行列 U の積で表すこと
    - 普通 LU 分解といったときには、L の対角成分は１とする
    - L が正方行列でない場合も、a_ij の i=j 成分を１とする
  - 利点
    - 対角成分を１とする分、決めるべき未知数が減る
  - 利点
  - 低ランク近似
  - 特異値分解されたもののうち、上位のランクだけ選んで再構成する
  - 画像処理なドで使う
- Cholesky 分解
  - 多次元正規分布に従う乱数生成で使う
- QR 分解
  - 実行列から
  - 直交行列と上三角行列の積へ
  - 用途
    - 線形最小二乗法
  - 計算に用いる手法
    - ギブンス回転
    - ハウスホルダー変換
    - グラム・シュミット分解

## Mapping <a id="mapping" name="mapping"></a>

- Mapping 写像
  - とは
- Kernel
  - A が与えられたとき、Ax = O に移ってくるような x の集合を A の核という
  - Ker A と表記する
- Image
  - A が与えられたとき、x を動かした時に y=Ax がとり得る集合を A の像という
  - Im A と表記する
- 単射
- 全射
- 全単射
- 同相写像
  - 位相構造を保存する。
  - 開集合を保存する。
- 同型写像
  - 線形構造を保存する。
  - 同型写像は（線形）部分空間を保存する。
- 準同型写像
- 連続写像
- 恒等写像
- 逆写像
- 開写像
- 閉写像
- 次元定理

## Rank 階 <a id="rank" name="rank"></a>

- 同値な定義
- A の一次独立な行ベクトルの最大本数
  - A の一次独立な列ベクトルの最大本数
  - 階段形にしたときに 0 でない成分が残る行の数
    - 実際にランクを計算する方法がこれ
  - ランク標準形にしたときに 1 が並ぶ数
  - dim(ImA) ，つまり A の像の次元
  - A の 0 でない特異値の数（AA⊤ の 0 でない固有値の数）
- 用途
  - 正方行列の正則性の判定
    - nxn 行列のランクが n なら、正則である
  - 方程式の階の個数の判定
    - 解がある
      - 解が有限個ある
      - 解が無数にある
    - 解がない

## Determinant 行列式 <a id="determinant" name="determinant"></a>

- |A||B|=|AB|
- 転置行列の行列式は等しい
- 行列式の用途
  - 余因子行列を求める
  - 終結式
    - ２つの方程式の係数からなる行列式
      - １次結合の方程式のみ？
    - ゼロのとき、２つの方程式は同一解を持つ
      - すべて一致？一部一致？
  - グラムの行列式
    - １次独立の判定法
- 置換
- 互換

## Vector <a id="vector" name="vector"></a>

- 基底ベクトル
  - 正規直交基底
- 双対基底ベクトル aka 相反基底ベクトル
- 成分
  - 共変ベクトル成分
  - 反変ベクトル成分
- ベクトル空間
  - 一次独立（aka 線形独立）
  - 双対ベクトル空間
  - 部分空間
- 内積
- 外積
- スカラー三重積
- ベクトル三重積
- 直積
- ナブラ
- 勾配
  - ナブラとスカラーの積なので、ベクトル
- 発散
  - ナブラとベクトルの内積なので、スカラー ベクトルが流れ出す・流れ込む方向を示す
- 回転
  - ナブラとベクトルの外積なので、ベクトル
- ラプラシアン
  - 勾配の発散なので、スカラー
  - くぼみ検出器であり、ピーク探知機でもある
- ポアソン方程式
- ラプラス方程式
  - 電荷密度がゼロの領域でのポアソン方程式

### ベクトルの微分

- ベクトルをスカラーで微分
  - 単に各要素に対して微分 結果はベクトル
- スカラーをベクトルで微分
  - v = (x, y, z)でスカラー f を微分するなら、結果は(∂f/∂x, ∂f/∂y, ∂f/∂z) 結果はベクトル
- ベクトルをベクトルで微分
  - v = (x, y, z)で f を微分するなら、結果は(∂f/∂x, ∂f/∂y, ∂f/∂z)
  - 結果は行列

### ベクトルの積分

- 線積分
- 面積分
- 体積分
- ヤコビアン
- ガウスの定理
- ストークスの定理
- グリーンの定理
- ３次元曲線
- 接ベクトル tangent vector
- 主法線ベクトル
- 従法線ベクトル
- 包絡線
- 曲率 κ
  - 曲がり具合
- 捩率 τ
  - 平面曲線からの離れ具合
- フレネセレの公式

## Tensor <a id="tensor" name="tensor"></a>

- 計量テンソル aka 基本テンソル
  ミンコフスキー計量
- 混合テンソル
- 共変テンソル
- 双対反変テンソル
- 共変計量テンソル
- 慣性テンソル
  - 慣性モーメント
  - 慣性乗積
  - 回転した座標系で慣性テンソルを求める方法
    - A.計算し直す
    - B.相似変換
- リーマン曲率テンソル
  - 交換子: commutator
- リッチテンソル
- リッチスカラー
- 共変テンソル成分
- 反変テンソル成分
- 相似変換
- ローレンツ変換
  - 「ローレンツ変換に対して共変的」
- 反変成分
- 共変成分
- １形式　 aka コベクトル
- マクスウェル方程式
  - 電場のガウスの法則
  - 磁場のガウスの法則
  - ファラデーの法則
  - アンペール・マクスウェルの法則
  - （連続の式）
- 演算
  - テンソル加法
  - テンソル減法
  - 内積
  - 共変微分
  - テンソルの縮約
- 記法
  - 共変添字
  - 反変添字
  - アインシュタインの規約
  - クリストッフェル記号
- テンソル場

## アフィン変換 <a id="affin" name="affin"></a>

- アフィン変換
  - 平行移動と線形変換のみの変換のこと
  - 平行移動
  - 線形変換
    - 変換の前に直線だった場所は、変換後も直線のまま保たれる」変換のこと
    - 直線が変換によって曲がったりしない 直線上に点 A,B,C が並んでいたとき、変換の前後で AB:BC の比が変化しない
- 具体例
  - differential scaling 拡大縮小
  - rotation 回転
  - skew 剪断
  - translation 平行移動
- 行列表現
  - ２次元
    - 線形変換
      - 線形変換行列（正方行列である）と元のベクトルの積
    - 平行移動
      - 上記に足す
    - 以上の２つをまとめて一つの積のみで書くこともできる
      - 同次変換
- アフィン集合
